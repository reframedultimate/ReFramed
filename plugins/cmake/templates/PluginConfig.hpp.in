#pragma once

#define STRINGIFY_(x) #x
#define STRINGIFY(x) STRINGIFY_(x)

#define PLUGIN_VERSION_MAJOR ${PROJECT_VERSION_MAJOR}
#define PLUGIN_VERSION_MINOR ${PROJECT_VERSION_MINOR}
#define PLUGIN_VERSION_PATCH ${PROJECT_VERSION_PATCH}
#define PLUGIN_VERSION \
    ((PLUGIN_VERSION_MAJOR << 24) | (PLUGIN_VERSION_MINOR << 16) | (PLUGIN_VERSION_PATCH << 8))
#define PLUGIN_VERSION_STR \
    STRINGIFY(PLUGIN_VERSION_MAJOR) "." STRINGIFY(PLUGIN_VERSION_MINOR) "." STRINGIFY(PLUGIN_VERSION_PATCH)

#if defined(PLUGIN_BUILDING)
#   define PLUGIN_API ${PLUGIN_API_EXPORT}
#else
#   define PLUGIN_API ${PLUGIN_API_IMPORT}
#endif

#define DEFINE_PLUGIN(factories, start, stop) \
    extern "C" { \
        PLUGIN_API RFPluginInterface plugin_interface = {PLUGIN_VERSION, factories, start, stop}; \
    }
